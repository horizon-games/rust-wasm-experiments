!function(t){function e(e){for(var i,s,r=e[0],o=e[1],a=0,l=[];a<r.length;a++)s=r[a],n[s]&&l.push(n[s][0]),n[s]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);for(h&&h(e);l.length;)l.shift()()}var i={},n={0:0};var s={};var r={2:function(){return{"./ball_wasm":{__wbg_sqrt_6ac1ec864938feb9:function(t){return i[1].exports.__wbg_sqrt_6ac1ec864938feb9(t)},__wbg_random_918d3291fe65513c:function(){return i[1].exports.__wbg_random_918d3291fe65513c()},__wbindgen_throw:function(t,e){return i[1].exports.__wbindgen_throw(t,e)}}}}};function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(t){var e=[],i=n[t];if(0!==i)if(i)e.push(i[2]);else{var a=new Promise(function(e,s){i=n[t]=[e,s]});e.push(i[2]=a);var l,c=document.getElementsByTagName("head")[0],h=document.createElement("script");h.charset="utf-8",h.timeout=120,o.nc&&h.setAttribute("nonce",o.nc),h.src=function(t){return o.p+""+t+".bundle.js"}(t),l=function(e){h.onerror=h.onload=null,clearTimeout(u);var i=n[t];if(0!==i){if(i){var s=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src,o=new Error("Loading chunk "+t+" failed.\n("+s+": "+r+")");o.type=s,o.request=r,i[1](o)}n[t]=void 0}};var u=setTimeout(function(){l({type:"timeout",target:h})},12e4);h.onerror=h.onload=l,c.appendChild(h)}return({1:[2]}[t]||[]).forEach(function(t){var i=s[t];if(i)e.push(i);else{var n,a=r[t](),l=fetch(o.p+""+{2:"4783bab8b76c15aa2430"}[t]+".module.wasm");if(a instanceof Promise&&"function"==typeof WebAssembly.compileStreaming)n=Promise.all([WebAssembly.compileStreaming(l),a]).then(function(t){return WebAssembly.instantiate(t[0],t[1])});else if("function"==typeof WebAssembly.instantiateStreaming)n=WebAssembly.instantiateStreaming(l,a);else{n=l.then(function(t){return t.arrayBuffer()}).then(function(t){return WebAssembly.instantiate(t,a)})}e.push(s[t]=n.then(function(e){return o.w[t]=(e.instance||e).exports}))}}),Promise.all(e)},o.m=t,o.c=i,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o.oe=function(t){throw console.error(t),t},o.w={};var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var h=l;o(o.s=0)}([function(t,e,i){"use strict";i.r(e);const n=300;function s(){const t=[],e={width:window.innerWidth,height:window.innerHeight,mode:"wasm-compute-js-render-canvas",track:function(i){if("function"!=typeof i)throw new Error("Must be a function that will be called on window resize to update width / height");i(e),t.push(i)}},i=function(t,e){let i;return function(...n){clearTimeout(i),i=setTimeout(()=>t.apply(this,n),e)}}(()=>{e.width=window.innerWidth,e.height=window.innerHeight,t.forEach(t=>{t(e)})},n);return window.addEventListener("resize",i,!1),{cleanup:()=>{window.removeEventListener("resize",i)},stage:e}}function r(t){const e=document.getElementById("root"),i=document.createElement("p"),n=function(){const t=document.createElement("div");return t.className="wasm-compute-js-render-html js-compute-js-render-html",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.zIndex=-1,t}(),s=function(){const t=document.createElement("canvas");return t.className="wasm-compute-js-render-canvas js-compute-js-render-canvas",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.zIndex=-1,t}();t.track(({width:t,height:e})=>{s.width=t,s.height=e}),t.track(({width:t,height:e})=>{n.style.width=`${t}px`,n.style.height=`${e}px`});const r=function(t=[],e){const i=t.map(t=>{const i=document.createElement("input");i.name="render-mode",i.type="radio",i.value=t.value,i.id=t.value,i.checked=e.mode===t.value,i.onchange=(t=>{[...document.getElementsByClassName(e.mode)].forEach(t=>t.style.display="none"),e.mode=t.target.value,[...document.getElementsByClassName(e.mode)].forEach(t=>t.style.display="block")});const n=document.createElement("label");n.innerText=t.label,n.htmlFor=t.value;const s=document.createElement("li");return s.appendChild(i),s.appendChild(n),s}),n=document.createElement("ul");return i.forEach(t=>n.appendChild(t)),n.style.listStyle="none",n.style.paddingLeft="20px",n}([{value:"wasm-compute-js-render-canvas",label:"compute by WASM - render by JS into canvas"},{value:"wasm-compute-js-render-html",label:"compute by WASM - render by JS into html"},{value:"js-compute-js-render-canvas",label:"compute by JS - render by JS into canvas"},{value:"js-compute-js-render-html",label:"compute by JS - render by JS into html"}],t);return e.appendChild(r),e.appendChild(i),e.appendChild(s),e.appendChild(n),{rootNode:e,infosNode:i,canvasRenderNode:s,canvasCtx:s.getContext("2d"),htmlRenderNode:n}}class o{constructor(t,e){this.x=t,this.y=e}get_length(){return Math.sqrt(this.x*this.x+this.y*this.y)}dot(t){return this.x*t.x+this.y*t.y}normalize(){return new o(this.x/this.get_length(),this.y/this.get_length())}scale(t){return new o(this.x*t,this.y*t)}}var a=o;var l=class{constructor(t,e,i,n,s,r,o,a,l){this.x=t,this.y=e,this.velocity_x=i,this.velocity_y=n,this.radius=s,this.mass=r,this.gravity=o,this.elasticity=a,this.friction=l}step(){this.x=this.x+this.gravity*this.velocity_x,this.y=this.y+this.gravity*this.velocity_y,this.velocity_x=this.friction*this.velocity_x,this.velocity_y=this.friction*this.velocity_y}manageStageBorderCollision(t,e){this.x-this.radius<0&&(this.velocity_x=-this.velocity_x*this.elasticity,this.x=this.radius),this.x+this.radius>t&&(this.velocity_x=-this.velocity_x*this.elasticity,this.x=t-this.radius),this.y-this.radius<0&&(this.velocity_y=-this.velocity_y*this.elasticity,this.y=this.radius),this.y+this.radius>e&&(this.velocity_y=-this.velocity_y*this.elasticity,this.y=e-this.radius)}checkBallCollision(t){const e=this.x-t.x,i=this.y-t.y,n=this.radius+t.radius;return e*e+i*i<=n*n}resolveBallCollision(t){const e=this.get_vector_2d(t),i=e.get_length(),n=e.scale((this.radius+t.radius-i)/i),s=1/this.mass,r=1/t.mass,o=new a(this.velocity_x-t.velocity_x,this.velocity_y-t.velocity_y),l=n.normalize(),c=o.dot(l);if(c>0)return;const h=-1.85*c/(s+r),u=l.scale(h),d=u.scale(s),y=u.scale(r);this.velocity_x=(this.velocity_x+d.x)*this.elasticity,this.velocity_y=(this.velocity_y+d.y)*this.elasticity,t.velocity_x=(t.velocity_x-y.x)*this.elasticity,t.velocity_y=(t.velocity_y-y.y)*this.elasticity}setRandomPositionAndSpeedInBounds(t,e){this.x=this.random()*t,this.y=this.random()*e,this.velocity_x=10*this.random(),this.velocity_y=10*this.random()}get_vector_2d(t){return new a(this.x-t.x,this.y-t.y)}random(){return Math.random()}};const c=1.3,h=1,u=.98,d=1;i.e(1).then(i.bind(null,1)).then(t=>{function e({x:e=0,y:i=0,velocityX:n=0,velocityY:s=0,radius:r=15,mass:o=c,gravity:a=h,elasticity:y=u,friction:m=d,wasm:f=!0}={}){return new(f?t.Ball:l)(e,i,n,s,r,o,a,y,m)}function i(t){t.forEach(t=>t.step()),t.forEach(t=>t.manageStageBorderCollision(y.width,y.height));for(let e=0;e<t.length;e++)for(let i=e+1;i<t.length;i++)!0===t[e].checkBallCollision(t[i])&&t[e].resolveBallCollision(t[i])}function n(t,e,i="#900000"){e.fillStyle=i,e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!0),e.closePath(),e.fill()}function o(t,e="#900000"){return`<div class="ball" style="position:absolute;top:${t.y-t.radius}px;left:${t.x-t.radius}px;background:${e};width:${2*t.radius}px;height:${2*t.radius}px;border-radius:${t.radius}px"></div>`}const a={"wasm-compute-js-render-canvas":function(){f.clearRect(0,0,y.width,y.height),w.wasm.forEach(t=>n(t,f,"blue"))},"wasm-compute-js-render-html":function(){p.innerHTML=w.wasm.map(t=>o(t,"darkblue")).join("")},"js-compute-js-render-canvas":function(){f.clearRect(0,0,y.width,y.height),w.js.forEach(t=>n(t,f,"red"))},"js-compute-js-render-html":function(){p.innerHTML=w.js.map(t=>o(t,"darkred")).join("")}};const{stage:y}=s(),{infosNode:m,canvasCtx:f,htmlRenderNode:p}=r(y);let v=0,g=0;const w={wasm:Array.from(Array(10),t=>e()),js:Array.from(Array(10),t=>e({wasm:!1}))};w.wasm.forEach(t=>{t.setRandomPositionAndSpeedInBounds(y.width,y.height)}),w.js.forEach(t=>{t.setRandomPositionAndSpeedInBounds(y.width,y.height)}),function t(e){requestAnimationFrame(t),v=e-g,i(w.wasm),i(w.js),m.innerText=`Delta: ${v.toFixed(4)}ms - FrameRate: ${Math.round(1e3/v)} FPS`,a[y.mode](),g=e}()})}]);
//# sourceMappingURL=bundle.js.map